[customizations.kernel]
# These arguments are appended to the TARGET system's bootloader
append = "mitigations=off nowatchdog amd_pstate=active"

[customizations.installer.kickstart]
contents = """
# --- ANACONDA KICKSTART CONFIG ---
# This defines how the installer runs and partitions the drive

lang en_US.UTF-8
keyboard us
timezone America/New_York --utc
network --bootproto=dhcp --device=link --activate

# --- DISK PARTITIONING ---
# CAUTION: This will WIPE the NVMe drive
zerombr
clearpart --all --initlabel --drives=nvme0n1
ignoredisk --only-use=nvme0n1

# Standard Fedora Atomic Partition Layout
part /boot/efi --fstype=efi --size=600 --ondisk=nvme0n1
part /boot     --fstype=ext4 --size=1024 --ondisk=nvme0n1
part btrfs.01  --fstype=btrfs --grow --ondisk=nvme0n1

# BTRFS Subvolumes
btrfs /     --subvol --name=root btrfs.01
btrfs /home --subvol --name=home btrfs.01
btrfs /var  --subvol --name=var  btrfs.01

bootloader --location=auto --boot-drive=nvme0n1

# Reboot after successful install
reboot
"""