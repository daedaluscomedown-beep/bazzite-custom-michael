[customizations]
hostname = "deconfliction-pc"

[customizations.installer]
# Unattended removed to allow kickstart control

[customizations.installer.kickstart]
contents = """
# ============================================================================
# BAZZITE BTRFS FOUNDATION (Autopart Failsafe)
# ============================================================================
lang en_US.UTF-8
keyboard us
timezone America/New_York --utc
network --bootproto=dhcp --device=link --activate
rootpw --plaintext changeme

# 1. Drive Selection
# We wipe everything and force the installer to only see the NVMe drive.
zerombr
clearpart --all --initlabel --drives=nvme0n1
ignoredisk --only-use=nvme0n1

# 2. Partitioning (The Fix)
# Instead of manual lines, we let Anaconda calculate the perfect BTRFS layout.
autopart --type=btrfs

# 3. Bootloader
# We let the installer handle the bootloader installation automatically.
bootloader --location=none --boot-drive=nvme0n1

reboot

%post
echo "BTRFS Failsafe Installed."
%end
"""