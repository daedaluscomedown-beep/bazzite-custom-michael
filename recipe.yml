name: bazzite-custom-michael
description: "Golden Image for Michael's RX 9070 / 5800X3D Rig"
base-image: ghcr.io/ublue-os/bazzite-kde
image-version: stable

modules:
  # 1. Copy our custom config files, EDID, and Service Units
  - type: files
    files:
      - usr: /usr
      - etc: /etc

  # 2. Install hardware tools (COSMIC Removed)
  - type: rpm-ostree
    install:
      - ryzenadj        # Undervolting Tool
      - alsa-firmware   # G6 Audio Firmware
      - lact            # GPU Tuning Tool
      - terra-gpg-keys  # We keep this so the key is ready for post-install

  # 3. Core Apps (System-Wide Flatpaks)
  - type: default-flatpaks
    notify: true
    system: true
    install:
      - com.google.Chrome      # Default Browser
      - dev.vencord.Vesktop    # Discord (Optimized)

  # 4. Apply Kernel Args & Tweaks
  - type: script
    scripts:
      - kargs.sh
      - tweaks.sh
      - disable-terra.sh  # <--- CRITICAL: Ensures ISO build succeeds